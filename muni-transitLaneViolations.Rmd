---
title: "Analysis of Transit Only Lane Violations for SFMTA"
author: Anthony Chau
date: 07-10-2018
output: html_notebook
---


```{r}
muni <- read.csv('muni_transitLanes.csv')

# Convert muni object to a data frame class
muni <- as.data.frame(muni)

# Check variables in muni
str(muni)
summary(muni)

```
# Cleaning the Data

First, we remove the Citation.Issue.Month column from the data frame since the
month is already included in the Citation.Issue.Date column. And, we remove the 
Last.Edited.Date column because this is not relevant for our analysis.
```{r}
muni$Citaton.Issue.Month <- NULL
muni$Last.Edited.Date <- NULL
```

Now, let's focus our attention on the date and time data within this dataset.

Initially, the citation issue date and time were stored as factor variables. We collapse date and time into a single column and convert it to a datetime object. This will make the data easier to work with in our analysis.
```{r}
# Convert citation dates and times to a Datetime object

muni$Citation.Date <- strptime(paste(muni$Citation.Issue.Date, 
                                            muni$Citation.Issue.Time), 
                                      format ='%m/%d/%Y %H:%M')

# Drop original citation issue date and time

muni$Citation.Issue.Date <- NULL
muni$Citation.Issue.Time <- NULL

str(muni)

table(muni$Violation.Code)
table(muni$Violation)
table(muni$Citation.Status)
table(muni$Disposition.Code)
table(muni$Suspend.Process.Date)
```


We want to collaspe observations in the location column to only record a unique
factor level for a street name.
```{r}
library(stringr)

muni$Location <- as.character(muni$Location)

muni$Location <- str_replace_all(muni$Location, "[:punct:]", "")

### Testing code

# Split location into street number and street name
# Logic: If a word boundary is proceeded by a digit, split the word
y <- lapply(strsplit(muni$Location, "(?<=\\d)\\b ", perl=T), function(x) if (length(x)<2) c("", x) else x)

# Create new matrix with street name column and street name column
y <- do.call(rbind, y)

# Check unique street names
unique(y[,2])


```

